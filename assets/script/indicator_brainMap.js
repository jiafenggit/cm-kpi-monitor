;(function( $ ) {
tttt = [{"children":[{"children":[{"children":[{"children":[{"children":[],"data":{"id":302,"type":"kpirelate"},"delta":0,"id":"302","rel":0,"state":"","text":"基准客户数"},{"children":[],"data":{"id":301,"type":"kpirelate"},"delta":0,"id":"301","rel":0,"state":"","text":"ARPU>=5元的累计净增客户数"}],"data":{"id":3,"type":"kpi"},"delta":1,"id":"3","rel":3,"state":"","text":"客户发展增幅"},{"children":[{"children":[],"data":{"id":202,"type":"kpirelate"},"delta":0,"id":"202","rel":0,"state":"","text":"新增激活数"},{"children":[],"data":{"id":210,"type":"kpirelate"},"delta":0,"id":"210","rel":0,"state":"","text":"在网且ARPU达标客户保有率"},{"children":[],"data":{"id":206,"type":"kpirelate"},"delta":0,"id":"206","rel":0,"state":"","text":"新增价值客户存活量"},{"children":[],"data":{"id":204,"type":"kpirelate"},"delta":0,"id":"204","rel":0,"state":"","text":"新增属地落地数"},{"children":[],"data":{"id":208,"type":"kpirelate"},"delta":0,"id":"208","rel":0,"state":"","text":"ARPU>=20元新增客户数"},{"children":[],"data":{"id":205,"type":"kpirelate"},"delta":0,"id":"205","rel":0,"state":"","text":"ARPU>=5元新增属地落地数"},{"children":[],"data":{"id":209,"type":"kpirelate"},"delta":0,"id":"209","rel":0,"state":"","text":"语音ARPU>=10元的新增客户数"},{"children":[],"data":{"id":201,"type":"kpirelate"},"delta":0,"id":"201","rel":0,"state":"","text":"放卡量"},{"children":[],"data":{"id":203,"type":"kpirelate"},"delta":0,"id":"203","rel":0,"state":"","text":"新增有效激活数"},{"children":[],"data":{"id":207,"type":"kpirelate"},"delta":0,"id":"207","rel":0,"state":"","text":"新增客户在网量"},{"children":[],"data":{"id":211,"type":"kpirelate"},"delta":0,"id":"211","rel":0,"state":"","text":"在网且ARPU达标客户保有量"}],"data":{"id":2,"type":"kpi"},"delta":1,"id":"2","rel":2,"state":"","text":"新增价值客户存活率"},{"children":[{"children":[],"data":{"id":102,"type":"kpirelate"},"delta":1,"id":"102","rel":102,"state":"","text":"新增客户数"},{"children":[],"data":{"id":103,"type":"kpirelate"},"delta":0,"id":"103","rel":0,"state":"","text":"净增客户数"},{"children":[],"data":{"id":111,"type":"kpirelate"},"delta":0,"id":"111","rel":0,"state":"","text":"ARPU>=5元的迁出客户数"},{"children":[],"data":{"id":101,"type":"kpirelate"},"delta":1,"id":"101","rel":101,"state":"","text":"到达客户数"},{"children":[],"data":{"id":109,"type":"kpirelate"},"delta":0,"id":"109","rel":0,"state":"","text":"ARPU>=5元的离网客户数"},{"children":[],"data":{"id":107,"type":"kpirelate"},"delta":0,"id":"107","rel":0,"state":"","text":"ARPU>=5元的到达客户数"},{"children":[],"data":{"id":104,"type":"kpirelate"},"delta":0,"id":"104","rel":0,"state":"","text":"离网客户数"},{"children":[],"data":{"id":110,"type":"kpirelate"},"delta":0,"id":"110","rel":0,"state":"","text":"ARPU>=5元的迁入客户数"},{"children":[],"data":{"id":105,"type":"kpirelate"},"delta":0,"id":"105","rel":0,"state":"","text":"迁入客户数"},{"children":[],"data":{"id":108,"type":"kpirelate"},"delta":0,"id":"108","rel":0,"state":"","text":"ARPU>=5元的新增客户数"},{"children":[],"data":{"id":106,"type":"kpirelate"},"delta":0,"id":"106","rel":0,"state":"","text":"迁出客户数"}],"data":{"id":1,"type":"kpi"},"delta":1,"id":"1","rel":1,"state":"","text":"净增客户数（arpu>=5）"}],"data":{"id":5,"type":"kpitype"},"delta":0,"id":"5","rel":5,"state":"","text":"客户发展"},{"children":[{"children":[{"children":[],"data":{"id":401,"type":"kpirelate"},"delta":0,"id":"401","rel":0,"state":"","text":"G3手机终端客户数"},{"children":[],"data":{"id":413,"type":"kpirelate"},"delta":0,"id":"413","rel":0,"state":"","text":"G3数据卡新增客户数"},{"children":[],"data":{"id":407,"type":"kpirelate"},"delta":0,"id":"407","rel":0,"state":"","text":"G3数据卡净增客户数（窜货核减前）"},{"children":[],"data":{"id":405,"type":"kpirelate"},"delta":0,"id":"405","rel":0,"state":"","text":"G3手机终端净增客户数（窜货核减前）"},{"children":[],"data":{"id":403,"type":"kpirelate"},"delta":0,"id":"403","rel":0,"state":"","text":"G3数据卡客户数"},{"children":[],"data":{"id":409,"type":"kpirelate"},"delta":0,"id":"409","rel":0,"state":"","text":"G3迁入客户数"},{"children":[],"data":{"id":412,"type":"kpirelate"},"delta":0,"id":"412","rel":0,"state":"","text":"G3无线座机新增客户数"},{"children":[],"data":{"id":402,"type":"kpirelate"},"delta":0,"id":"402","rel":0,"state":"","text":"G3无线座机客户数"},{"children":[],"data":{"id":411,"type":"kpirelate"},"delta":0,"id":"411","rel":0,"state":"","text":"G3手机终端新增客户数"},{"children":[],"data":{"id":404,"type":"kpirelate"},"delta":0,"id":"404","rel":0,"state":"","text":"G3上网本客户数"},{"children":[],"data":{"id":406,"type":"kpirelate"},"delta":0,"id":"406","rel":0,"state":"","text":"G3无线座机净增客户数（窜货核减前）"},{"children":[],"data":{"id":410,"type":"kpirelate"},"delta":0,"id":"410","rel":0,"state":"","text":"G3迁出客户数"},{"children":[],"data":{"id":414,"type":"kpirelate"},"delta":0,"id":"414","rel":0,"state":"","text":"G3上网本新增客户数"},{"children":[],"data":{"id":408,"type":"kpirelate"},"delta":0,"id":"408","rel":0,"state":"","text":"G3上网本净增客户数（窜货核减前）"}],"data":{"id":4,"type":"kpi"},"delta":0,"id":"4","rel":0,"state":"","text":"G3客户净增"}],"data":{"id":6,"type":"kpitype"},"delta":0,"id":"6","rel":6,"state":"","text":"G3客户净增"},{"children":[{"children":[{"children":[],"data":{"id":502,"type":"kpirelate"},"delta":0,"id":"502","rel":0,"state":"","text":"存量客户数据业务店员积分（一期积分）"},{"children":[],"data":{"id":504,"type":"kpirelate"},"delta":0,"id":"504","rel":0,"state":"","text":"卡通业务办理量积分"},{"children":[],"data":{"id":501,"type":"kpirelate"},"delta":0,"id":"501","rel":0,"state":"","text":"新增客户数据业务店员积分（一期积分）"},{"children":[],"data":{"id":503,"type":"kpirelate"},"delta":0,"id":"503","rel":0,"state":"","text":"数据业务店员积分（二期积分）"}],"data":{"id":5,"type":"kpi"},"delta":0,"id":"5","rel":0,"state":"","text":"办理量总积分"},{"children":[{"children":[],"data":{"id":701,"type":"kpirelate"},"delta":0,"id":"701","rel":0,"state":"","text":"上月办理量"},{"children":[],"data":{"id":703,"type":"kpirelate"},"delta":0,"id":"703","rel":0,"state":"","text":"当月办理量"},{"children":[],"data":{"id":704,"type":"kpirelate"},"delta":0,"id":"704","rel":0,"state":"","text":"集团稽核标准当月高质办理量"},{"children":[],"data":{"id":702,"type":"kpirelate"},"delta":0,"id":"702","rel":0,"state":"","text":"北京稽核标准上月高质办理量"}],"data":{"id":7,"type":"kpi"},"delta":0,"id":"7","rel":0,"state":"","text":"数据业务健康度"},{"children":[{"children":[],"data":{"id":604,"type":"kpirelate"},"delta":0,"id":"604","rel":0,"state":"","text":"手机阅读核减量"},{"children":[],"data":{"id":602,"type":"kpirelate"},"delta":0,"id":"602","rel":0,"state":"","text":"手机支付核减量"},{"children":[],"data":{"id":601,"type":"kpirelate"},"delta":0,"id":"601","rel":0,"state":"","text":"手机支付业务办理量"},{"children":[],"data":{"id":603,"type":"kpirelate"},"delta":0,"id":"603","rel":0,"state":"","text":"手机阅读业务办理量"}],"data":{"id":6,"type":"kpi"},"delta":0,"id":"6","rel":0,"state":"","text":"战略产品办理量"}],"data":{"id":7,"type":"kpitype"},"delta":0,"id":"7","rel":7,"state":"","text":"重点数据增值业务"},{"children":[{"children":[{"children":[],"data":{"id":902,"type":"kpirelate"},"delta":0,"id":"902","rel":0,"state":"","text":"G3无线座机低MOU客户数"},{"children":[],"data":{"id":901,"type":"kpirelate"},"delta":0,"id":"901","rel":0,"state":"","text":"G3手机终端低MOU客户数"},{"children":[],"data":{"id":802,"type":"kpirelate"},"delta":0,"id":"802","rel":0,"state":"","text":"G3手机终端在网量"}],"data":{"id":9,"type":"kpi"},"delta":0,"id":"9","rel":0,"state":"","text":"低MOU客户占比"},{"children":[{"children":[],"data":{"id":803,"type":"kpirelate"},"delta":0,"id":"803","rel":0,"state":"","text":"G3无线座机销售量"},{"children":[],"data":{"id":801,"type":"kpirelate"},"delta":0,"id":"801","rel":0,"state":"","text":"G3手机终端销售量"},{"children":[],"data":{"id":804,"type":"kpirelate"},"delta":0,"id":"804","rel":0,"state":"","text":"G3无线座机在网量"},{"children":[],"data":{"id":802,"type":"kpirelate"},"delta":0,"id":"802","rel":0,"state":"","text":"G3手机终端在网量"}],"data":{"id":8,"type":"kpi"},"delta":0,"id":"8","rel":0,"state":"","text":"年累计的G3在网率"}],"data":{"id":8,"type":"kpitype"},"delta":0,"id":"8","rel":8,"state":"","text":"终端营销健康度"},{"children":[{"children":[],"data":{"id":10,"type":"kpi"},"delta":1,"id":"10","rel":10,"state":"current","text":"运营收入"}],"data":{"id":9,"type":"kpitype"},"delta":0,"id":"9","rel":9,"state":"","text":"运营收入"}],"data":{"id":1,"type":"kpitype"},"delta":0,"id":"1","rel":1,"state":"","text":"销售类指标"},{"children":[{"children":[{"children":[{"children":[],"data":{"id":1101,"type":"kpirelate"},"delta":0,"id":"1101","rel":0,"state":"","text":"整体业务量"},{"children":[],"data":{"id":1102,"type":"kpirelate"},"delta":0,"id":"1102","rel":0,"state":"","text":"短信评价触发量"},{"children":[],"data":{"id":1103,"type":"kpirelate"},"delta":0,"id":"1103","rel":0,"state":"","text":"参与评价量"}],"data":{"id":11,"type":"kpi"},"delta":0,"id":"11","rel":0,"state":"","text":"短信评价参与率"},{"children":[{"children":[],"data":{"id":1201,"type":"kpirelate"},"delta":0,"id":"1201","rel":0,"state":"","text":"10分评价人次"},{"children":[],"data":{"id":1204,"type":"kpirelate"},"delta":0,"id":"1204","rel":0,"state":"","text":"服务态度不满意人次"},{"children":[],"data":{"id":1208,"type":"kpirelate"},"delta":0,"id":"1208","rel":0,"state":"","text":"未二次回复人次"},{"children":[],"data":{"id":1206,"type":"kpirelate"},"delta":0,"id":"1206","rel":0,"state":"","text":"对等候时间不满意人次"},{"children":[],"data":{"id":1207,"type":"kpirelate"},"delta":0,"id":"1207","rel":0,"state":"","text":"其他原因不满意人次"},{"children":[],"data":{"id":1205,"type":"kpirelate"},"delta":0,"id":"1205","rel":0,"state":"","text":"办理结果不满意人次"},{"children":[],"data":{"id":1202,"type":"kpirelate"},"delta":0,"id":"1202","rel":0,"state":"","text":"9-8分评价人次"},{"children":[],"data":{"id":1203,"type":"kpirelate"},"delta":0,"id":"1203","rel":0,"state":"","text":"7分及以下评价人次"}],"data":{"id":12,"type":"kpi"},"delta":0,"id":"12","rel":0,"state":"","text":"短信评价满意率"}],"data":{"id":10,"type":"kpitype"},"delta":0,"id":"10","rel":10,"state":"","text":"客户评价指标"},{"children":[{"children":[{"children":[],"data":{"id":1401,"type":"kpirelate"},"delta":0,"id":"1401","rel":0,"state":"","text":"平均等候时长"},{"children":[],"data":{"id":1403,"type":"kpirelate"},"delta":0,"id":"1403","rel":0,"state":"","text":"业务办理总时长"},{"children":[],"data":{"id":1402,"type":"kpirelate"},"delta":0,"id":"1402","rel":0,"state":"","text":"业务办理量"},{"children":[],"data":{"id":1404,"type":"kpirelate"},"delta":0,"id":"1404","rel":0,"state":"","text":"重点业务办理量"},{"children":[],"data":{"id":1405,"type":"kpirelate"},"delta":0,"id":"1405","rel":0,"state":"","text":"重点业务平均办理时长"}],"data":{"id":14,"type":"kpi"},"delta":0,"id":"14","rel":0,"state":"","text":"平均办理时长"},{"children":[{"children":[],"data":{"id":1603,"type":"kpirelate"},"delta":0,"id":"1603","rel":0,"state":"","text":"营业主厅前台充值卡办理量"},{"children":[],"data":{"id":1601,"type":"kpirelate"},"delta":0,"id":"1601","rel":0,"state":"","text":"自助终端充值卡办理量"},{"children":[],"data":{"id":1602,"type":"kpirelate"},"delta":0,"id":"1602","rel":0,"state":"","text":"体验终端充值卡办理量"}],"data":{"id":16,"type":"kpi"},"delta":0,"id":"16","rel":0,"state":"","text":"营业厅充值卡业务现场分流率"},{"children":[{"children":[],"data":{"id":1503,"type":"kpirelate"},"delta":0,"id":"1503","rel":0,"state":"","text":"营业主厅前台全球通交费办理量"},{"children":[],"data":{"id":1501,"type":"kpirelate"},"delta":0,"id":"1501","rel":0,"state":"","text":"自助终端全球通交费办理量"},{"children":[],"data":{"id":1502,"type":"kpirelate"},"delta":0,"id":"1502","rel":0,"state":"","text":"体验终端全球通交费办理量"}],"data":{"id":15,"type":"kpi"},"delta":0,"id":"15","rel":0,"state":"","text":"营业厅前台现场交费业务分流率"},{"children":[{"children":[],"data":{"id":1302,"type":"kpirelate"},"delta":0,"id":"1302","rel":0,"state":"","text":"等候超时量"},{"children":[],"data":{"id":1301,"type":"kpirelate"},"delta":0,"id":"1301","rel":0,"state":"","text":"服管系统叫号量"}],"data":{"id":13,"type":"kpi"},"delta":0,"id":"13","rel":0,"state":"","text":"客户等候超时比例"},{"children":[],"data":{"id":17,"type":"kpi"},"delta":0,"id":"17","rel":0,"state":"","text":"营业厅主厅套餐类业务现场分流率"}],"data":{"id":11,"type":"kpitype"},"delta":0,"id":"11","rel":11,"state":"","text":"内部指标控制"}],"data":{"id":2,"type":"kpitype"},"delta":0,"id":"2","rel":2,"state":"","text":"服务类指标"},{"children":[{"children":[{"children":[{"children":[],"data":{"id":2001,"type":"kpirelate"},"delta":0,"id":"2001","rel":0,"state":"","text":"体验营销业务办理量"},{"children":[],"data":{"id":2003,"type":"kpirelate"},"delta":0,"id":"2003","rel":0,"state":"","text":"营业厅内登陆网上营业厅数据业务办理量"},{"children":[],"data":{"id":2002,"type":"kpirelate"},"delta":0,"id":"2002","rel":0,"state":"","text":"营业厅体验系统数据业务办理量"}],"data":{"id":20,"type":"kpi"},"delta":0,"id":"20","rel":0,"state":"","text":"体验营销业务办理量积分值"},{"children":[{"children":[],"data":{"id":1804,"type":"kpirelate"},"delta":0,"id":"1804","rel":0,"state":"","text":"动感地带家庭计划半年套餐业务办理量"},{"children":[],"data":{"id":1808,"type":"kpirelate"},"delta":0,"id":"1808","rel":0,"state":"","text":"神州行家园卡年套餐业务办理量"},{"children":[],"data":{"id":1805,"type":"kpirelate"},"delta":0,"id":"1805","rel":0,"state":"","text":"动感地带21元网聊年套餐包业务办理量"},{"children":[],"data":{"id":1809,"type":"kpirelate"},"delta":0,"id":"1809","rel":0,"state":"","text":"神州行家园卡半年套餐业务办理量"},{"children":[],"data":{"id":1806,"type":"kpirelate"},"delta":0,"id":"1806","rel":0,"state":"","text":"神州行畅听卡年套餐业务办理量"},{"children":[],"data":{"id":1801,"type":"kpirelate"},"delta":0,"id":"1801","rel":0,"state":"","text":"重点业务套餐办理量"},{"children":[],"data":{"id":1807,"type":"kpirelate"},"delta":0,"id":"1807","rel":0,"state":"","text":"神州行畅听卡半年套餐业务办理量"},{"children":[],"data":{"id":1810,"type":"kpirelate"},"delta":0,"id":"1810","rel":0,"state":"","text":"无线座机卡年套餐业务办理量"},{"children":[],"data":{"id":1802,"type":"kpirelate"},"delta":0,"id":"1802","rel":0,"state":"","text":"全球通家庭计划年套餐业务办理量"},{"children":[],"data":{"id":1803,"type":"kpirelate"},"delta":0,"id":"1803","rel":0,"state":"","text":"动感地带家庭计划年套餐业务办理量"}],"data":{"id":18,"type":"kpi"},"delta":0,"id":"18","rel":0,"state":"","text":"重点业务套餐办理量积分值"},{"children":[{"children":[],"data":{"id":1904,"type":"kpirelate"},"delta":0,"id":"1904","rel":0,"state":"","text":"预付费企信通业务累计办理量"},{"children":[],"data":{"id":1901,"type":"kpirelate"},"delta":0,"id":"1901","rel":0,"state":"","text":"集团产品套餐办理量"},{"children":[],"data":{"id":1902,"type":"kpirelate"},"delta":0,"id":"1902","rel":0,"state":"","text":"BES业务累计办理量"},{"children":[],"data":{"id":1903,"type":"kpirelate"},"delta":0,"id":"1903","rel":0,"state":"","text":"BIS业务累计办理量"}],"data":{"id":19,"type":"kpi"},"delta":0,"id":"19","rel":0,"state":"","text":"集团产品套餐办理量积分值"}],"data":{"id":12,"type":"kpitype"},"delta":0,"id":"12","rel":12,"state":"","text":"自营厅重点业务积分"},{"children":[{"children":[{"children":[],"data":{"id":2101,"type":"kpirelate"},"delta":0,"id":"2101","rel":0,"state":"","text":"发展客户数达标专营店数量"}],"data":{"id":21,"type":"kpi"},"delta":0,"id":"21","rel":0,"state":"","text":"业务能力达标专营厅数量"},{"children":[],"data":{"id":22,"type":"kpi"},"delta":0,"id":"22","rel":0,"state":"","text":"业务能力达标混营厅数量"}],"data":{"id":13,"type":"kpitype"},"delta":0,"id":"13","rel":13,"state":"","text":"社会渠道与业务能力达标考核"},{"children":[{"children":[{"children":[],"data":{"id":2502,"type":"kpirelate"},"delta":0,"id":"2502","rel":0,"state":"","text":"分公司信息化收入"},{"children":[],"data":{"id":2501,"type":"kpirelate"},"delta":0,"id":"2501","rel":0,"state":"","text":"分公司代理商信息化收入"}],"data":{"id":25,"type":"kpi"},"delta":0,"id":"25","rel":0,"state":"","text":"代理商信息化收入占比"},{"children":[{"children":[],"data":{"id":2304,"type":"kpirelate"},"delta":0,"id":"2304","rel":0,"state":"","text":"合作厅店员积分集团业务办理量"},{"children":[],"data":{"id":2309,"type":"kpirelate"},"delta":0,"id":"2309","rel":0,"state":"","text":"合作厅店员积分集团业务本年月累计办理量"},{"children":[],"data":{"id":2301,"type":"kpirelate"},"delta":0,"id":"2301","rel":0,"state":"","text":"自营厅CRM集团业务办理量"},{"children":[],"data":{"id":2308,"type":"kpirelate"},"delta":0,"id":"2308","rel":0,"state":"","text":"合作厅CRM集团业务本年月累计办理量"},{"children":[],"data":{"id":2306,"type":"kpirelate"},"delta":0,"id":"2306","rel":0,"state":"","text":"自营厅CRM集团业务本年月累计办理量"},{"children":[],"data":{"id":2310,"type":"kpirelate"},"delta":0,"id":"2310","rel":0,"state":"","text":"分公司集团业务助理集团业务本年月累计办理量"},{"children":[],"data":{"id":2302,"type":"kpirelate"},"delta":0,"id":"2302","rel":0,"state":"","text":"自营厅店员积分集团业务办理量"},{"children":[],"data":{"id":2303,"type":"kpirelate"},"delta":0,"id":"2303","rel":0,"state":"","text":"合作厅CRM集团业务办理量"},{"children":[],"data":{"id":2305,"type":"kpirelate"},"delta":0,"id":"2305","rel":0,"state":"","text":"分公司集团业务助理集团业务办理量"},{"children":[],"data":{"id":2307,"type":"kpirelate"},"delta":0,"id":"2307","rel":0,"state":"","text":"自营厅店员积分集团业务本年月累计办理量"}],"data":{"id":23,"type":"kpi"},"delta":0,"id":"23","rel":0,"state":"","text":"自营厅/合作厅业务受理能力"},{"children":[],"data":{"id":24,"type":"kpi"},"delta":0,"id":"24","rel":0,"state":"","text":"代理商数量"},{"children":[{"children":[],"data":{"id":2602,"type":"kpirelate"},"delta":0,"id":"2602","rel":0,"state":"","text":"分公司所有渠道拓展中小企业成员数"},{"children":[],"data":{"id":2601,"type":"kpirelate"},"delta":0,"id":"2601","rel":0,"state":"","text":"分公司代理商拓展中小企业成员数"}],"data":{"id":26,"type":"kpi"},"delta":0,"id":"26","rel":0,"state":"","text":"中小企业成员客户拓展量占比"}],"data":{"id":14,"type":"kpitype"},"delta":0,"id":"14","rel":14,"state":"","text":"集团客户渠道能力"}],"data":{"id":3,"type":"kpitype"},"delta":0,"id":"3","rel":3,"state":"","text":"渠道类指标"},{"children":[{"children":[{"children":[{"children":[],"data":{"id":1806,"type":"kpirelate"},"delta":0,"id":"1806","rel":0,"state":"","text":"神州行畅听卡年套餐业务办理量"},{"children":[],"data":{"id":1809,"type":"kpirelate"},"delta":0,"id":"1809","rel":0,"state":"","text":"神州行家园卡半年套餐业务办理量"},{"children":[],"data":{"id":1804,"type":"kpirelate"},"delta":0,"id":"1804","rel":0,"state":"","text":"动感地带家庭计划半年套餐业务办理量"},{"children":[],"data":{"id":1805,"type":"kpirelate"},"delta":0,"id":"1805","rel":0,"state":"","text":"动感地带21元网聊年套餐包业务办理量"},{"children":[],"data":{"id":1808,"type":"kpirelate"},"delta":0,"id":"1808","rel":0,"state":"","text":"神州行家园卡年套餐业务办理量"},{"children":[],"data":{"id":1801,"type":"kpirelate"},"delta":0,"id":"1801","rel":0,"state":"","text":"重点业务套餐办理量"},{"children":[],"data":{"id":1810,"type":"kpirelate"},"delta":0,"id":"1810","rel":0,"state":"","text":"无线座机卡年套餐业务办理量"},{"children":[],"data":{"id":1807,"type":"kpirelate"},"delta":0,"id":"1807","rel":0,"state":"","text":"神州行畅听卡半年套餐业务办理量"},{"children":[],"data":{"id":1802,"type":"kpirelate"},"delta":0,"id":"1802","rel":0,"state":"","text":"全球通家庭计划年套餐业务办理量"},{"children":[],"data":{"id":1803,"type":"kpirelate"},"delta":0,"id":"1803","rel":0,"state":"","text":"动感地带家庭计划年套餐业务办理量"}],"data":{"id":18,"type":"kpitype"},"delta":0,"id":"18","rel":18,"state":"","text":"test"}],"data":{"id":15,"type":"kpitype"},"delta":0,"id":"15","rel":15,"state":"","text":"集团信息化收入"},{"children":[{"children":[],"data":{"id":28,"type":"kpi"},"delta":0,"id":"28","rel":0,"state":"","text":"转型业务收入"}],"data":{"id":16,"type":"kpitype"},"delta":0,"id":"16","rel":16,"state":"","text":"转型业务收入"},{"children":[{"children":[{"children":[],"data":{"id":2902,"type":"kpirelate"},"delta":0,"id":"2902","rel":0,"state":"","text":"重点集团客户总数"},{"children":[],"data":{"id":2901,"type":"kpirelate"},"delta":0,"id":"2901","rel":0,"state":"","text":"重点集团客户保有数"}],"data":{"id":29,"type":"kpi"},"delta":1,"id":"29","rel":29,"state":"","text":"重点客户保有率"}],"data":{"id":17,"type":"kpitype"},"delta":0,"id":"17","rel":17,"state":"","text":"重点客户保有率"}],"data":{"id":4,"type":"kpitype"},"delta":0,"id":"4","rel":4,"state":"","text":"集团客户类指标"}],"data":{"id":0,"type":"kpitype"},"delta":0,"id":"0","rel":0,"state":"root","text":"KPI分类"}];

brainMapJSON = [{
	text: "G3客户净增",
		delta: 0,
		data: {id:1, value:9},
		state: "root",
		children: [{
			text: "净增客户数",
			delta: 0,
			data: {id:2, value:9},
			state: "",
			children: [{
				text: "客户发展增幅2",
				delta: -1,
				data: {id:3, value:9},
				state: "",
				children: [{
					text: "客户发展增幅2",
					delta: 0,
					data: {id:4, value:9},
					state: "",
					children: []
				}, {
					text: "测试一下3",
					delta: 0,
					data: {id:5, value:9},
					state: "",
					children: []
				}]
			},{
				text: "客户发展增幅current",
				delta: 0,
				data: {id:6, value:9},
				state: "",
				children: [{
					text: "客户发展增幅2",
					delta: -1,
					data: {id:7, value:9},
					state: "",
					children: []
				}, {
					text: "测试一下3",
					delta: 0,
					data: {id:8, value:9},
					state: "",
					children: []
				}]
			}]
		}, {
			text: "客户发展增幅1",
			delta: 0,
			data: {id:9, value:9},
			state: "",
			children: [{
				text: "客户发展增幅2",
				delta: 0,
				data: {id:10, value:9},
				state: "",
				children: []
			}, {
				text: "测试一下5",
				delta: 0,
				data: {id:11, value:9},
				state: "",
				children: []
			}, {
				text: "测试一下5",
				delta: 0,
				data: {id:12, value:9},
				state: "",
				children: [{
					text: "测试一下5",
					delta: 0,
					data: {id:13, value:9},
					state: "",
					children: []
				}, {
					text: "测试一下5",
					delta: 0,
					data: {id:14, value:9},
					state: "",
					children: [{
						text: "测试一下5",
						delta: 0,
						data: {id:15, value:9},
						state: "",
						children: [{
							text: "测试一下5",
							delta: 0,
							data: {id:16, value:9},
							state: "",
							children: []
						}, {
							text: "测试一下5",
							delta: 0,
							data: {id:17, value:9},
							state: "",
							children: []
						}]
					}, {
						text: "测试一下5",
						delta: 0,
						data: {id:18, value:9},
						state: "",
						children: []
					}]
				}, {
					text: "测试一下5",
					delta: 0,
					data: {id:19, value:9},
					state: "",
					children: []
				}]
			}, {
				text: "测试一下5",
				delta: 0,
				data: {id:20, value:9},
				state: "",
				children: []
			}, {
				text: "测试一下5",
				delta: 0,
				data: {id:21, value:9},
				state: "",
				children: []
			}, {
				text: "测试一下5",
				delta: 0,
				data: {id:22, value:9},
				state: "",
				children: []
			}, {
				text: "测试一下5",
				delta: 0,
				data: {id:23, value:9},
				state: "",
				children: []
			}]
		}, {
			text: "测试一下2",
			delta: 1,
			data: {id:24, value:9},
			state: "",
			children: [{
				text: "测试一下5",
				delta: 0,
				data: {id:25, value:9},
				state: "",
				children: []
			}, {
				text: "测试一下5",
				delta: 0,
				data: {id:26, value:9},
				state: "current",
				children: [{
					text: "测试一下5",
					delta: 0,
					data: {id:27, value:9},
					state: "",
					children: []
				}, {
					text: "测试一下5",
					delta: 0,
					data: {id:28, value:9},
					state: "",
					children: []
				}]
			}]
		}]
}];

brainMap = [{
		text: "G3客户净增",
		delta: 0,
		data: {id:1, value:0},
		state: "root",
		children: [{
			text: "净增客户数",
			delta: 0,
			data: {id:2, value:0},
			state: "",
			children: [{
				text: "客户发展增幅2",
				delta: 1,
				data: {id:3, value:0},
				state: "",
				children: [{
					text: "客户发展增幅2",
					delta: 1,
					data: {id:4, value:0},
					state: "",
					children: []
				}, {
					text: "测试一下3",
					delta: 0,
					data: {id:5, value:0},
					state: "",
					children: []
				}]
			},{
				text: "客户发展增幅current",
				delta: 0,
				data: {id:6, value:0},
				state: "",
				children: [{
					text: "客户发展增幅2",
					delta: 1,
					data: {id:7, value:0},
					state: "",
					children: []
				}, {
					text: "测试一下3",
					delta: 0,
					data: {id:8, value:0},
					state: "",
					children: []
				}]
			}]
		}, {
			text: "客户发展增幅1",
			delta: -1,
			data: {id:9, value:0},
			state: "",
			children: [{
				text: "客户发展增幅2",
				delta: 0,
				data: {id:10, value:0},
				state: "",
				children: []
			}, {
				text: "测试一下5",
				delta: 0,
				data: {id:11, value:0},
				state: "",
				children: []
			}, {
				text: "测试一下5",
				delta: 0,
				data: {id:12, value:0},
				state: "",
				children: [{
					text: "测试一下5",
					delta: 0,
					data: {id:13, value:0},
					state: "",
					children: []
				}, {
					text: "测试一下5",
					delta: 0,
					data: {id:14, value:0},
					state: "",
					children: [{
						text: "测试一下5",
						delta: 0,
						data: {id:15, value:0},
						state: "",
						children: [{
							text: "测试一下5",
							delta: 0,
							data: {id:16, value:0},
							state: "",
							children: []
						}, {
							text: "测试一下5",
							delta: 0,
							data: {id:17, value:0},
							state: "",
							children: []
						}]
					}, {
						text: "测试一下5",
						delta: 0,
						data: {id:18, value:0},
						state: "",
						children: []
					}]
				}, {
					text: "测试一下5",
					delta: 0,
					data: {id:19, value:0},
					state: "",
					children: []
				}]
			}, {
				text: "测试一下5",
				delta: 0,
				data: {id:20, value:0},
				state: "",
				children: []
			}, {
				text: "测试一下5",
				delta: 0,
				data: {id:21, value:0},
				state: "",
				children: []
			}, {
				text: "测试一下5",
				delta: 0,
				data: {id:22, value:0},
				state: "",
				children: []
			}, {
				text: "测试一下5",
				delta: 0,
				data: {id:23, value:0},
				state: "",
				children: []
			}]
		}, {
			text: "测试一下2",
			delta: 0,
			data: {id:24, value:0},
			state: "",
			children: [{
				text: "测试一下5",
				delta: 0,
				data: {id:25, value:0},
				state: "",
				children: []
			}, {
				text: "测试一下5",
				delta: 0,
				data: {id:26, value:0},
				state: "current",
				children: [{
					text: "测试一下5",
					delta: 0,
					data: {id:27, value:0},
					state: "",
					children: []
				}, {
					text: "测试一下5",
					delta: 0,
					data: {id:28, value:0},
					state: "",
					children: []
				}]
			}]
		}]
	}];

function _getPageSize() {
	var xScroll, yScroll;
	if (window.innerHeight && window.scrollMaxY) {	
		xScroll = window.innerWidth + window.scrollMaxX;
		yScroll = window.innerHeight + window.scrollMaxY;
	} else if (document.body.scrollHeight > document.body.offsetHeight){ // all but Explorer Mac
		xScroll = document.body.scrollWidth;
		yScroll = document.body.scrollHeight;
	} else { // Explorer Mac...would also work in Explorer 6 Strict, Mozilla and Safari
		xScroll = document.body.offsetWidth;
		yScroll = document.body.offsetHeight;
	}
	var windowWidth, windowHeight;
	if (self.innerHeight) {	// all except Explorer
		if(document.documentElement.clientWidth){
			windowWidth = document.documentElement.clientWidth; 
		} else {
			windowWidth = self.innerWidth;
		}
		windowHeight = self.innerHeight;
	} else if (document.documentElement && document.documentElement.clientHeight) { // Explorer 6 Strict Mode
		windowWidth = document.documentElement.clientWidth;
		windowHeight = document.documentElement.clientHeight;
	} else if (document.body) { // other Explorers
		windowWidth = document.body.clientWidth;
		windowHeight = document.body.clientHeight;
	}	
	// for small pages with total height less then height of the viewport
	if(yScroll < windowHeight){
		pageHeight = windowHeight;
	} else { 
		pageHeight = yScroll;
	}
	// for small pages with total width less then width of the viewport
	if(xScroll < windowWidth){	
		pageWidth = xScroll;		
	} else {
		pageWidth = windowWidth;
	}
	arrayPageSize = new Array(pageWidth,pageHeight,windowWidth,windowHeight);
	return arrayPageSize;
};

function calcBrainMapSize(){
	var viewHeight = _getPageSize()[3],
		offset = $("#brainMap").offset(),
		mapTop = offset.top;

	$("#brainMap").height(viewHeight - mapTop - 40);
}

$(function(){
	calcBrainMapSize();
	window.onresize = calcBrainMapSize;
	
	$("#areaSelector").select({
		option: arrMapDict, 
		width: 300,
		onSelect: function(val, txt){
			alert(val + "-" + txt);
			
			//重新加载节点，在发ajax请求前调用该方法显示"正在加载..."提示
			$.fn.brainMap.updateIndicate("open");
			//这里用setTimeout模拟了ajax的时延，实际应该在ajax回调中执行$.fn.brainMap.update函数，并传入新的JSON
			//该函数执行结束后，"正在加载..."提示会自动关闭
			setTimeout( "$.fn.brainMap.update(brainMapJSON)", 3000);
			
		}
	});

	$("#dateSelector").dateSelect({
		onSelect:function(date){
			alert(date);
			
			//重新加载节点，在发ajax请求前调用该方法显示"正在加载..."提示
			$.fn.brainMap.updateIndicate("open");
			//这里用setTimeout模拟了ajax的时延，实际应该在ajax回调中执行$.fn.brainMap.update函数，并传入新的JSON
			//该函数执行结束后，"正在加载..."提示会自动关闭
			setTimeout( "$.fn.brainMap.update(brainMapJSON)", 3000);
		}
	});

	$("#back-btn").click(function(){
		alert("要返回，请到assets/script/indicator_brainMap.js中实现我");
	});

	//初始化脑图
	$("#brainMap div.stage-inner").brainMap({
		json: brainMap,
		onSelect: eventBrainMapNodeSelect,
		onUpdate: eventBrainMapUpdate
	});

	//添加脑图画布的拖动事件
	$( ".stage" ).mouscroll({
		handle: ".stage-inner-wrap",
		cancel: ".bm-node"
	}); 

});

})( jQuery );

function eventBrainMapNodeSelect(e, data, isSelected){
	alert(data.value);

	if(isSelected){
		//更新面板数据
		$("#indicator-selected h5").text($(e.target).text());
		$("#indicator-selected").show();
	} else {
		$("#indicator-selected").hide();
	}
}

//此函数为脑图update时的回调
function eventBrainMapUpdate(selectedNodeData){
	//如果在更新节点内容之前已经有节点处于选中状态，则这里应该更新左边第二个数据面板中的数据
	var selectedNodeData = $("div.bm-node.selected").data("data");

	if (selectedNodeData) {
		//请将这里替换为更新面板数据
		alert(selectedNodeData.value);
	}
}
